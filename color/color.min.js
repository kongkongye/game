window.Color=function(){var n=function(n,t,o){if(n)return $("<br>");var i=$("<span>"+t+"</span>");return r(i,o),i},r=function(n,r){t(r).split(ColorConstant.CHAR).forEach(function(r){r&&(o(r)?n.addClass("color-"+r):i(r)&&n.addClass("format-"+r))})},t=function(n){for(var r=n.split("#").filter(function(n){return!!n}).join(""),t=r.length-1;t>=0;t--)if(o(r[t])){r=r.substr(t);break}var i="";return Common.getUniqueChars(r).split("").forEach(function(n){i+="#"+n}),i},o=function(n){return 1===n.length&&-1!==ColorConstant.COLORS.indexOf(n)},i=function(n){return 1===n.length&&-1!==ColorConstant.FORMATS.indexOf(n)};return{format:function(r){var t=[];return new Splitor(r).split().forEach(function(r){t.push(n(r.br,r.str,r.color))}),t},formatSingle:n,formatSingleDom:r,optimize:t,isChar:function(n){return n===ColorConstant.CHAR},isColor:o,isFormat:i,getLeadingColor:function(n){if(n&&n.length>=2&&n.substr(0,1)===ColorConstant.CHAR){var r=n.substr(1,1);if(o(r))return r}return null},isBr:function(n){return n===ColorConstant.BR}}}();